left_join(rename(aluetyyppi, alue = "kunta"), by = "alue") %>%
group_by(aluetyyppi, time, pendelointi, koulutusaste, ika) %>%
summarise(values = sum(values)) %>%
ungroup() %>%
mutate(aluetyyppi = as_factor(aluetyyppi))
dat_lahtopendelointi_tyyppi <-
dat_lahtopendelointi %>%
filter(alue != "KOKO MAA") %>%
left_join(rename(aluetyyppi, alue = "kunta"), by = "alue") %>%
group_by(aluetyyppi, time, pendelointi, koulutusaste, ika) %>%
summarise(values = sum(values)) %>%
ungroup() %>%
mutate(aluetyyppi = as_factor(aluetyyppi))
usethis::use_data(dat_lahtopendelointi_tyyppi, dat_tulopendelointi_tyyppi, overwrite = TRUE)
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line()
library(RColorBrewer)
display.brewer.pal(2, "Blues")
display.brewer.pal(4, "Blues")
display.brewer.pal(6, "Blues")
atyyppi_colour <- c(brewer.pal(3, "Oranges"), brewer.pal(3, "Blues") , brewer.pal(3, "Greens"))
brewer.pal(2, "Oranges")
atyyppi_colour <- c(brewer.pal(4, "Oranges")[2,4], brewer.pal(4, "Blues")[2,4] , brewer.pal(3, "Greens"))
atyyppi_colour <- c(brewer.pal(4, "Oranges")[c(2,4)], brewer.pal(4, "Blues")[c(2,4)] , brewer.pal(3, "Greens"))
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(tidyverse)
library(ggptt)
library(RColorBrewer)
set_ptt()
atyyppi_colour <- c(brewer.pal(4, "Oranges")[c(2,4)], brewer.pal(4, "Blues")[c(2,4)] , brewer.pal(6, "Greens")[6:4])
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour)
atyyppi_colour <- c(brewer.pal(6, "Oranges")[6:5], brewer.pal(6, "Blues")[6:5] , brewer.pal(6, "Greens")[6:4])
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour)
atyyppi_colour <- c(brewer.pal(6, "Oranges")[6:4], brewer.pal(6, "Blues")[6:5] , brewer.pal(6, "Greens")[6:5])
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour)
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = 100 * pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "y", "l")) +
labs(subtitle = "Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueella",
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus")
?theme
theme_update(plot.subtitle = element_text(colour = "grey50", size = 1))
atyyppi_colour <- c(brewer.pal(6, "Oranges")[6:4], brewer.pal(6, "Blues")[6:5] , brewer.pal(6, "Greens")[6:5])
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = 100 * pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "y", "l")) +
labs(subtitle = "Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueella",
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus")
theme_update(plot.subtitle = element_text(colour = "grey50", size = 9))
atyyppi_colour <- c(brewer.pal(6, "Oranges")[6:4], brewer.pal(6, "Blues")[6:5] , brewer.pal(6, "Greens")[6:5])
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = 100 * pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "y", "l")) +
labs(subtitle = "Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueella",
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus")
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(tidyverse)
library(ggptt)
library(RColorBrewer)
set_ptt()
theme_update(plot.subtitle = element_text(colour = "grey50", size = 9))
atyyppi_colour <- c(brewer.pal(6, "Oranges")[6:4], brewer.pal(6, "Blues")[6:5] , brewer.pal(6, "Greens")[6:5])
time_range <- range(dat_tulopendelointi$time)
time_range
library(glue)
time_range
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = 100 * pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "l")) +
labs(subtitle = glue("Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueella",
"vuosina {time_range[1]}-{time_range[2]}."),
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus",
y = "%")
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = 100 * pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "l")) +
labs(subtitle = glue("Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueella",
"vuosina {time_range[1]}-{time_range[2]}.", .sep = "/n"),
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus",
y = "%")
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = 100 * pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "l")) +
labs(subtitle = glue("Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueella",
"vuosina {time_range[1]}-{time_range[2]}.", .sep = "\n"),
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus",
y = "%")
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "fig_pendelointi/"
)
library(tidyverse)
library(ggptt)
library(RColorBrewer)
library(glue)
set_ptt()
theme_update(plot.subtitle = element_text(colour = "grey50", size = 9))
atyyppi_colour <- c(brewer.pal(6, "Oranges")[6:4], brewer.pal(6, "Blues")[6:5] , brewer.pal(6, "Greens")[6:5])
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = pendeloivat) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line()
ggsave("fig_pendelointi/pend_atyyppi.png")
ggsave("pend_atyyppi.png")
time_range <- range(dat_tulopendelointi$time)
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = 100 * pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "l")) +
labs(subtitle = glue("Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueilla",
"vuosina {time_range[1]}-{time_range[2]}.", .sep = "\n"),
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus",
y = "%")
ggsave("pend_atyyppi.png")
dir("data-raw")
muutto_atyyppi <- read.csv2("muutto_atyyppi_ulos.csv")
muutto_atyyppi <- read.csv2("data-raw/muutto_atyyppi_ulos.csv")
muutto_ku_ulos <- read.csv2("data-raw/muutto_ku_ulos.csv")
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "fig_tyomuutto/"
)
library(tidyverse)
library(ggptt)
library(RColorBrewer)
library(glue)
set_ptt()
theme_update(plot.subtitle = element_text(colour = "grey50", size = 9))
atyyppi_colour <- c(brewer.pal(6, "Oranges")[6:4], brewer.pal(6, "Blues")[6:5] , brewer.pal(6, "Greens")[6:5])
dat_muuttotiedot_kunnittain <- readRDS("data/dat_muuttotiedot_kunnittain.rds")
dat_muuttotiedot_kunnittain <- readRDS("../data/dat_muuttotiedot_kunnittain.rds")
tyo_muutto_atyyppi <- read.csv2("data-raw/muutto_atyyppi_ulos.csv")
tyo_muutto_ku <- read.csv2("data-raw/muutto_ku_ulos.csv")
use_data(tyo_muutto_atyyppi, tyo_muutto_ku, overwrite = TRUE)
dat_muuttotiedot_kunnittain <- readRDS("../data/tyo_muutto_atyyppi.rds")
tyo_muutto_atyyppi <- readRDS("../data/tyo_muutto_atyyppi.rds")
tyo_muutto_atyyppi <- readRDS("../data/tyo_muutto_atyyppi.rda")
load("../data/tyo_muutto_atyyppi.rda")
load("../data/tyo_muutto_ku.rda")
levels(tyo_muutto_atyyppi$atyyppi)
tyo_muutto_atyyppi <- read.csv2("data-raw/muutto_atyyppi_ulos.csv") %>%
mutate(aluetyyppi = factor(atyyppi,
c("pk", "yokaup", "tkakeskus", "kaup", "kaupms", "ydinms", "ms"),
c("PK-seutu", "Muut yliopistokaupungit", "Muut TKA keskukset",
"Muut kaupungit", "Kaupunkien läh. maaseutu",
"Ydinmaaseutu", "Harvaan asuttu maaseutu")))
tyo_muutto_ku <- read.csv2("data-raw/muutto_ku_ulos.csv") %>%
mutate(aluetyyppi = factor(atyyppi,
c("pk", "yokaup", "tkakeskus", "kaup", "kaupms", "ydinms", "ms"),
c("PK-seutu", "Muut yliopistokaupungit", "Muut TKA keskukset",
"Muut kaupungit", "Kaupunkien läh. maaseutu",
"Ydinmaaseutu", "Harvaan asuttu maaseutu")))
tyo_muutto_ku <- read.csv2("data-raw/muutto_ku_ulos.csv")
use_data(tyo_muutto_atyyppi, tyo_muutto_ku, overwrite = TRUE)
time_range <- range(tyo_muutto_atyyppi$time)
time_range <- range(tyo_muutto_atyyppi$time)
tyo_muutto_atyyppi <- read.csv2("data-raw/muutto_atyyppi_ulos.csv") %>%
mutate(aluetyyppi = factor(atyyppi,
c("pk", "yokaup", "tkakeskus", "kaup", "kaupms", "ydinms", "ms"),
c("PK-seutu", "Muut yliopistokaupungit", "Muut TKA keskukset",
"Muut kaupungit", "Kaupunkien läh. maaseutu",
"Ydinmaaseutu", "Harvaan asuttu maaseutu"))) %>%
rename(time = vuosi)
tyo_muutto_atyyppi <- read.csv2("data-raw/muutto_atyyppi_ulos.csv") %>%
mutate(aluetyyppi = factor(atyyppi,
c("pk", "yokaup", "tkakeskus", "kaup", "kaupms", "ydinms", "ms"),
c("PK-seutu", "Muut yliopistokaupungit", "Muut TKA keskukset",
"Muut kaupungit", "Kaupunkien läh. maaseutu",
"Ydinmaaseutu", "Harvaan asuttu maaseutu"))) %>%
rename(time = vuosi) %>%
select(-atyyppi)
tyo_muutto_atyyppi <- read.csv2("data-raw/muutto_atyyppi_ulos.csv") %>%
mutate(aluetyyppi = factor(atyyppi,
c("pk", "yokaup", "tkakeskus", "kaup", "kaupms", "ydinms", "ms"),
c("PK-seutu", "Muut yliopistokaupungit", "Muut TKA keskukset",
"Muut kaupungit", "Kaupunkien läh. maaseutu",
"Ydinmaaseutu", "Harvaan asuttu maaseutu"))) %>%
mutate(tyo_muutto_netto = tyo_muutto_tulo - tyo_muutto_lahto,
tyopaikki_muutto_netto = tyopaikka_muutto_tulo - tyopaikka_muutto_lahto,
tyollistyy_muutto_netto = tyollistyy_muutto_tulo - tyollistyy_muutto_lahto) %>%
rename(time = vuosi) %>%
select(-atyyppi)
use_data(tyo_muutto_atyyppi, tyo_muutto_ku, overwrite = TRUE)
tyo_muutto_atyyppi <- read.csv2("data-raw/muutto_atyyppi_ulos.csv") %>%
mutate(aluetyyppi = factor(atyyppi,
c("pk", "yokaup", "tkakeskus", "kaup", "kaupms", "ydinms", "ms"),
c("PK-seutu", "Muut yliopistokaupungit", "Muut TKA keskukset",
"Muut kaupungit", "Kaupunkien läh. maaseutu",
"Ydinmaaseutu", "Harvaan asuttu maaseutu"))) %>%
mutate(tyo_muutto_netto = tyo_muutto_tulo - tyo_muutto_lahto,
tyopaikki_muutto_netto = tyopaikka_muutto_tulo - tyopaikka_muutto_lahto,
tyollistyy_muutto_netto = tyollistyy_muutto_tulo - tyollistyy_muutto_lahto,
tmuutto_netto = amuutto_tulo - amuutto_lahto) %>%
rename(time = vuosi,
tmuutto_tulo = tamuutto_tulo,
tmuutto_lahto = tamuutto_lahto) %>%
select(-atyyppi)
tyo_muutto_atyyppi <- read.csv2("data-raw/muutto_atyyppi_ulos.csv") %>%
mutate(aluetyyppi = factor(atyyppi,
c("pk", "yokaup", "tkakeskus", "kaup", "kaupms", "ydinms", "ms"),
c("PK-seutu", "Muut yliopistokaupungit", "Muut TKA keskukset",
"Muut kaupungit", "Kaupunkien läh. maaseutu",
"Ydinmaaseutu", "Harvaan asuttu maaseutu"))) %>%
mutate(tyo_muutto_netto = tyo_muutto_tulo - tyo_muutto_lahto,
tyopaikki_muutto_netto = tyopaikka_muutto_tulo - tyopaikka_muutto_lahto,
tyollistyy_muutto_netto = tyollistyy_muutto_tulo - tyollistyy_muutto_lahto,
tmuutto_netto = amuutto_tulo - amuutto_lahto) %>%
rename(time = vuosi,
tmuutto_tulo = amuutto_tulo,
tmuutto_lahto = amuutto_lahto) %>%
select(-atyyppi)
use_data(tyo_muutto_atyyppi, tyo_muutto_ku, overwrite = TRUE)
time_range <- range(tyo_muutto_atyyppi$time)
tyo_muutto_atyyppi %>%
select(time, aluetyyppi, 'Työperäinen' = tyo_muutto_netto, '18-80' = tmuutto_netto) %>%
gather(vars, values, -time, -aluetyyppi) %>%
ggplot(aes(time, values, colour = vars)) +
facet_wrap( ~ aluetyyppi) +
geom_line() +
scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "l")) +
labs(subtitle = glue("Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueilla",
"vuosina {time_range[1]}-{time_range[2]}.", .sep = "\n"),
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus",
y = "%")
tyo_muutto_atyyppi %>%
select(time, aluetyyppi, 'Työperäinen' = tyo_muutto_netto, '18-80' = tmuutto_netto) %>%
gather(vars, values, -time, -aluetyyppi) %>%
ggplot(aes(time, values, colour = vars)) +
facet_wrap( ~ aluetyyppi) +
geom_line() +
geom_h0() +
# scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "l")) +
labs(subtitle = glue("Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueilla",
"vuosina {time_range[1]}-{time_range[2]}.", .sep = "\n"),
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus",
y = "%")
View(tyo_muutto_atyyppi)
tyo_muutto_atyyppi %>%
group_by(time) %>%
summarise(netto = sum(tyo_muutto_netto))
tyo_muutto_atyyppi %>%
group_by(time) %>%
summarise(netto = sum(tmuutto_netto))
tyo_muutto_atyyppi %>%
select(time, aluetyyppi, 'Työperäinen' = tyo_muutto_netto, '18-80' = tmuutto_netto) %>%
mutate(aluetyyppi = fct_recode('Muu maaseutu' = "Ydinmaaseutu",
'Muu maaseutu' = "Harvaan asuttu maaseutu")) %>%
gather(vars, values, -time, -aluetyyppi) %>%
ggplot(aes(time, values, colour = vars)) +
facet_wrap( ~ aluetyyppi) +
geom_line() +
geom_h0() +
# scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "l")) +
labs(subtitle = glue("Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueilla",
"vuosina {time_range[1]}-{time_range[2]}.", .sep = "\n"),
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus",
y = "%")
tyo_muutto_atyyppi %>%
select(time, aluetyyppi, 'Työperäinen' = tyo_muutto_netto, '18-80' = tmuutto_netto) %>%
mutate(aluetyyppi = fct_recode(aluetyyppi,
'Muu maaseutu' = "Ydinmaaseutu",
'Muu maaseutu' = "Harvaan asuttu maaseutu")) %>%
group_by(time, aluetyyppi) %>%
summarise_all(sum) %>%
gather(vars, values, -time, -aluetyyppi) %>%
ggplot(aes(time, values, colour = vars)) +
facet_wrap( ~ aluetyyppi) +
geom_line() +
geom_h0() +
# scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "l")) +
labs(subtitle = glue("Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueilla",
"vuosina {time_range[1]}-{time_range[2]}.", .sep = "\n"),
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus",
y = "%")
tyo_muutto_atyyppi %>%
select(time, aluetyyppi, 'Työperäinen' = tyo_muutto_netto, '18-80' = tmuutto_netto) %>%
mutate(aluetyyppi = fct_recode(aluetyyppi,
'Muu maaseutu' = "Ydinmaaseutu",
'Muu maaseutu' = "Harvaan asuttu maaseutu")) %>%
group_by(time, aluetyyppi) %>%
summarise_all(sum) %>%
ungroup() %>%
gather(vars, values, -time, -aluetyyppi) %>%
ggplot(aes(time, values, colour = vars)) +
facet_wrap( ~ aluetyyppi) +
geom_line() +
geom_h0() +
# scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "l")) +
labs(subtitle = glue("Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueilla",
"vuosina {time_range[1]}-{time_range[2]}.", .sep = "\n"),
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus",
y = "%")
tyo_muutto_atyyppi %>%
select(time, aluetyyppi, 'Työperäinen' = tyo_muutto_netto, '18-80-vuotiaat' = tmuutto_netto) %>%
mutate(aluetyyppi = fct_recode(aluetyyppi,
'Muu maaseutu' = "Ydinmaaseutu",
'Muu maaseutu' = "Harvaan asuttu maaseutu")) %>%
group_by(time, aluetyyppi) %>%
summarise_all(sum) %>%
ungroup() %>%
gather(vars, values, -time, -aluetyyppi) %>%
ggplot(aes(time, values, colour = vars)) +
facet_wrap( ~ aluetyyppi) +
geom_line() +
geom_h0() +
# scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "l")) +
labs(subtitle = glue("Samana vuonna asuin ja työpaikan kuntaan muuttaneiden,
ja 18-80-vuotiaiden nettomuutto vuosina {time_range[1]}-{time_range[2]}.",
.sep = "\n"),
title = "Työperäinen nettomuutto",
caption = "Lähde: PTT, Tilastokeskus",
y = "henkeä")
tyo_muutto_atyyppi %>%
select(time, aluetyyppi, 'Työperäinen' = tyo_muutto_netto, '18-80-vuotiaat' = tmuutto_netto) %>%
mutate(aluetyyppi = fct_recode(aluetyyppi,
'Muu maaseutu' = "Ydinmaaseutu",
'Muu maaseutu' = "Harvaan asuttu maaseutu")) %>%
group_by(time, aluetyyppi) %>%
summarise_all(sum) %>%
ungroup() %>%
gather(vars, values, -time, -aluetyyppi) %>%
ggplot(aes(time, values, colour = vars)) +
facet_wrap( ~ aluetyyppi) +
geom_line() +
geom_h0() +
# scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "l")) +
labs(subtitle = glue("Samana vuonna asuin- ja työpaikan kuntaan vaihtaneiden
ja 18-80-vuotiaiden nettomuutto vuosina {time_range[1]}-{time_range[2]}.",
.sep = "\n"),
title = "Työperäinen nettomuutto",
caption = "Lähde: PTT, Tilastokeskus",
y = "henkeä")
ggsave("tyo_muutto_atyyppi.png")
ggsave("tyo_muutto_atyyppi.png", height = 5)
ggsave("tyo_muutto_atyyppi.png", height = 4)
time_range <- range(dat_tulopendelointi$time)
dat_tulopendelointi_tyyppi %>%
filter(koulutusaste == "Yhteensä",
ika == "Kaikki ikäluokat") %>%
mutate(pendelointi = fct_recode(pendelointi,
kaikki = "Alueella työssäkäyvät yhteensä",
asuinkunnassa = "Asuinkunnassaan työssäkäyvät",
pendeloivat = "Pendelöivät")) %>%
spread(pendelointi, values) %>%
mutate(values = 100 * pendeloivat / kaikki) %>%
ggplot(aes(time, values, colour = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour) +
the_title_blank(c("x", "l")) +
labs(subtitle = glue("Muissa kunnissa asuvien osuus kunnassa työssäkäyvistä keskimäärin alueilla",
"vuosina {time_range[1]}-{time_range[2]}.", .sep = "\n"),
title = "Pendelöijien osuus työssäkäyvistä",
caption = "Lähde: PTT, Tilastokeskus",
y = "%")
ggsave("pend_atyyppi.png", height = 4)
