"asuinkunnassaan_tyossakayvat", "pendeloivat", "tyolliset_yhteensa")
head(tulopendelointi_data)
head(lahtopendelointi_data)
lahtopendelointi_data <- select(lahtopendelointi_data, - tyolliset_yhteensa) %>%
rename(lahtopendelointi = pendeloivat)
tulopendelointi_data <- select(tulopendelointi_data, - tyolliset_yhteensa) %>%
rename(tulopendelointi = pendeloivat)
head(tulopendelointi_data)
head(lahtopendelointi_data)
pendelointi_data <- left_join(tulopendelointi_data, lahtopendelointi_data)
head(pendelointi_data)
head(pendelöinti)
# Save data
saveRDS(pendelointi_data, file = "R/data_clean/pendelointi_data.rds")
pendelointi_data %>% group_by(vuosi) %>%
summarize(pendelöijiä = sum(pendelöijät)) %>%
ggplot(aes(y = lahtopendelointi, x = vuosi)) +
geom_line() +
#ggtitle("Pendelöijien määrä Suomessa 1987 - 2015") + #Kuntien välinen pendelöinti
ylab("Pendelöijien määrä") +
xlab(NULL) +
scale_y_continuous(limits = c(400000,800000), labels = deci_comma)
pendelointi_data %>% group_by(vuosi) %>%
summarize(commuters = sum(lahtopendeloijat)) %>%
ggplot(aes(y = commuters, x = vuosi)) +
geom_line() +
#ggtitle("Pendelöijien määrä Suomessa 1987 - 2015") + #Kuntien välinen pendelöinti
ylab("Pendelöijien määrä") +
xlab(NULL) +
scale_y_continuous(limits = c(400000,800000), labels = deci_comma)
pendelointi_data %>% group_by(vuosi) %>%
summarize(commuters = sum(lahtopendelointi)) %>%
ggplot(aes(y = commuters, x = vuosi)) +
geom_line() +
#ggtitle("Pendelöijien määrä Suomessa 1987 - 2015") + #Kuntien välinen pendelöinti
ylab("Pendelöijien määrä") +
xlab(NULL) +
scale_y_continuous(limits = c(400000,800000), labels = deci_comma)
library(ggplot2)
search()
pendelointi_data %>% group_by(vuosi) %>%
summarize(commuters = sum(lahtopendelointi)) %>%
ggplot(aes(y = commuters, x = vuosi)) +
geom_line() +
#ggtitle("Pendelöijien määrä Suomessa 1987 - 2015") + #Kuntien välinen pendelöinti
ylab("Pendelöijien määrä") +
xlab(NULL) +
scale_y_continuous(limits = c(400000,800000), labels = deci_comma)
library(ggptt)
pendelointi_data %>% group_by(vuosi) %>%
summarize(commuters = sum(lahtopendelointi)) %>%
ggplot(aes(y = commuters, x = vuosi)) +
geom_line() +
#ggtitle("Pendelöijien määrä Suomessa 1987 - 2015") + #Kuntien välinen pendelöinti
ylab("Pendelöijien määrä") +
xlab(NULL) +
scale_y_continuous(limits = c(400000,800000), labels = deci_comma)
set_gg(theme_ptt(), "ptt")
pendelointi_data %>% group_by(vuosi) %>%
summarize(commuters = sum(lahtopendelointi)) %>%
ggplot(aes(y = commuters, x = vuosi)) +
geom_line() +
#ggtitle("Pendelöijien määrä Suomessa 1987 - 2015") + #Kuntien välinen pendelöinti
ylab("Pendelöijien määrä") +
xlab(NULL) +
scale_y_continuous(limits = c(400000,800000), labels = deci_comma)
pendelointi_data %>% group_by(vuosi) %>%
summarize(commuters = sum(tulopendelointi)) %>%
ggplot(aes(y = commuters, x = vuosi)) +
geom_line() +
#ggtitle("Pendelöijien määrä Suomessa 1987 - 2015") + #Kuntien välinen pendelöinti
ylab("Pendelöijien määrä") +
xlab(NULL) +
scale_y_continuous(limits = c(400000,800000), labels = deci_comma)
pendelöinti_data %>% group_by(vuosi) %>%
summarize(pendeloijat_yhteensa = sum(lahtopendelointi),
ei_pendelöijat_yhteensa = sum(asuinkunnassaan_työssakayvat)) %>%
mutate(pendelointiosuus = pendeloijat_yhteensa /
(pendeloijat_yhteensa + ei_pendeloijat_yhteensa)) %>%
ggplot(aes(y = pendelöintiosuus, x = vuosi)) +
geom_line() +
#ggtitle("Pendelöijien osuus työllisistä Suomessa 1987 - 2015") +
ylab("Pendelöijien osuus työllisistä") +
xlab(NULL) +
scale_y_continuous(limits = c(0.19,0.35), labels = percent_comma)
pendelointi_data %>% group_by(vuosi) %>%
summarize(pendeloijat_yhteensa = sum(lahtopendelointi),
ei_pendelöijat_yhteensa = sum(asuinkunnassaan_työssakayvat)) %>%
mutate(pendelointiosuus = pendeloijat_yhteensa /
(pendeloijat_yhteensa + ei_pendeloijat_yhteensa)) %>%
ggplot(aes(y = pendelöintiosuus, x = vuosi)) +
geom_line() +
#ggtitle("Pendelöijien osuus työllisistä Suomessa 1987 - 2015") +
ylab("Pendelöijien osuus työllisistä") +
xlab(NULL) +
scale_y_continuous(limits = c(0.19,0.35), labels = percent_comma)
pendelointi_data %>% group_by(vuosi) %>%
summarize(pendeloijat_yhteensa = sum(lahtopendelointi),
ei_pendelöijat_yhteensa = sum(asuinkunnassaan_tyossakayvat)) %>%
mutate(pendelointiosuus = pendeloijat_yhteensa /
(pendeloijat_yhteensa + ei_pendeloijat_yhteensa)) %>%
ggplot(aes(y = pendelöintiosuus, x = vuosi)) +
geom_line() +
#ggtitle("Pendelöijien osuus työllisistä Suomessa 1987 - 2015") +
ylab("Pendelöijien osuus työllisistä") +
xlab(NULL) +
scale_y_continuous(limits = c(0.19,0.35), labels = percent_comma)
pendelointi_data %>% group_by(vuosi) %>%
summarize(pendeloijat_yhteensa = sum(lahtopendelointi),
ei_pendeloijat_yhteensa = sum(asuinkunnassaan_tyossakayvat)) %>%
mutate(pendelointiosuus = pendeloijat_yhteensa /
(pendeloijat_yhteensa + ei_pendeloijat_yhteensa)) %>%
ggplot(aes(y = pendelöintiosuus, x = vuosi)) +
geom_line() +
#ggtitle("Pendelöijien osuus työllisistä Suomessa 1987 - 2015") +
ylab("Pendelöijien osuus työllisistä") +
xlab(NULL) +
scale_y_continuous(limits = c(0.19,0.35), labels = percent_comma)
pendelointi_data %>% group_by(vuosi) %>%
summarize(pendeloijat_yhteensa = sum(lahtopendelointi),
ei_pendeloijat_yhteensa = sum(asuinkunnassaan_tyossakayvat)) %>%
mutate(pendelointiosuus = pendeloijat_yhteensa /
(pendeloijat_yhteensa + ei_pendeloijat_yhteensa)) %>%
ggplot(aes(y = pendelointiosuus, x = vuosi)) +
geom_line() +
#ggtitle("Pendelöijien osuus työllisistä Suomessa 1987 - 2015") +
ylab("Pendelöijien osuus työllisistä") +
xlab(NULL) +
scale_y_continuous(limits = c(0.19,0.35), labels = percent_comma)
usethis::use_data_raw()
dir("data-raw")
aluetyyppi <- readxl::read_xls("data-raw/msindaluejaot10.xls")
aluetyyppi <- readxl::read_xls("data-raw/msindaluejaot10.xls")
library(tidyverse)
aluetyyppi <- readxl::read_xls("data-raw/msindaluejaot10.xls") %>%
mutate(kunta_no = statfitools::extract_code(Kunta),
kunta = statfitools::extract_name(Kunta),
aluetyyppi = coalesce(luokka2, Alueluokka))
aluetyyppi <- readxl::read_xls("data-raw/msindaluejaot10.xls") %>%
mutate(kunta_no = as_factor(statfitools::extract_code(Kunta, numbers_as_numeric = FALSE)),
kunta = as_factor(statfitools::extract_name(Kunta)),
aluetyyppi = coalesce(luokka2, Alueluokka))
aluetyyppi <- readxl::read_xls("data-raw/msindaluejaot10.xls") %>%
mutate(kunta_no = as_factor(statfitools::extract_code(Kunta, numbers_as_numeric = FALSE)),
kunta = as_factor(statfitools::extract_name(Kunta)),
aluetyyppi = coalesce(luokka2, Alueluokka)) %>%
select(kunta_no, kunta, aluetyyppi)
use_data(aluetyyppi, overwrite = TRUE)
aluetyyppi <- readxl::read_xls("data-raw/msindaluejaot10.xls") %>%
mutate(kunta_no = as_factor(statfitools::extract_code(Kunta, numbers_as_numeric = FALSE)),
kunta = as_factor(statfitools::extract_name(Kunta)),
aluetyyppi = coalesce(luokka2, Alueluokka)) %>%
select(kunta_no, kunta, aluetyyppi) %>%
mutate(aluetyyppi = fct_relevel(aluetyyppi,
rev(c("Harvaan asuttu maaseutu", "Ydinmaaseutu", "Kaupunkien läh. maaseutu",
"Kaupungit", "TKA", "YO", "PK seutu")))) %>%
mutate(aluetyyppi = fct_recode(aluetyyppi,
'Muut kaupungit' = "Kaupungit",
'Muut työssäkäyntialueden keskukset' = "TKA",
'Muut yliopistokaupungit' = "YO",
'PK-seutu' = "PK seutu"))
library(tidyverse)
use_data(aluetyyppi, overwrite = TRUE)
aluetyyppi <- readxl::read_xls("data-raw/msindaluejaot10.xls") %>%
mutate(kunta_no = as_factor(statfitools::extract_code(Kunta, numbers_as_numeric = FALSE)),
kunta = as_factor(statfitools::extract_name(Kunta)),
aluetyyppi = coalesce(luokka2, Alueluokka)) %>%
select(kunta_no, kunta, aluetyyppi) %>%
mutate(aluetyyppi = fct_relevel(aluetyyppi,
rev(c("Harvaan asuttu maaseutu", "Ydinmaaseutu", "Kaupunkien läh. maaseutu",
"Kaupungit", "TKA", "YO", "PK seutu")))) %>%
mutate(aluetyyppi = fct_recode(aluetyyppi,
'Muut kaupungit' = "Kaupungit",
'Muut työssäkäyntialueden keskukset' = "TKA",
'Muut yliopistokaupungit' = "YO",
'PK-seutu' = "PK seutu"))
# Load data
dat_muuttotiedot_kunnittain <- readRDS("data/dat_muuttotiedot_kunnittain.rds")
library(ggplot2)
library(tidyr)
library(dplyr)
library(ggppt)
library(ggptt)
library(statfitools)
set_ptt()
theme_update(plot.subtitle = element_text(colour = "grey50", size = 9))
atyyppi_colour <- c(brewer.pal(6, "Oranges")[6:4], brewer.pal(6, "Blues")[6:5] , brewer.pal(6, "Greens")[6:5])
library(RColorBrewer)
atyyppi_colour <- c(brewer.pal(6, "Oranges")[6:4], brewer.pal(6, "Blues")[6:5] , brewer.pal(6, "Greens")[6:5])
# Nettomuutot aluetyypeittäin, viiva
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuutto, color = aluetyyppi)) +
geom_line() +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
labs(x = NULL,
y = "Nettomuuttoja",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuutot",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain")
args(geom_hline)
# Nettomuutot aluetyypeittäin, viiva
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuutto, color = aluetyyppi)) +
geom_line() +
geom_hline(yintercept = 0, color = "black") +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
labs(x = NULL,
y = "Nettomuuttoja",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuutot",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain")
# Nettomuutot aluetyypeittäin, viiva
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuutto, color = aluetyyppi)) +
geom_line() +
geom_hline(yintercept = 0, color = "black", width = 10) +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
labs(x = NULL,
y = "Nettomuuttoja",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuutot",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain")
# Nettomuutot aluetyypeittäin, viiva
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuutto, color = aluetyyppi)) +
geom_line() +
geom_hline(yintercept = 0, color = "black", size = 10) +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
labs(x = NULL,
y = "Nettomuuttoja",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuutot",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain")
# Nettomuutot aluetyypeittäin, viiva
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuutto, color = aluetyyppi)) +
geom_line() +
geom_hline(yintercept = 0, color = "black", size = 2) +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
labs(x = NULL,
y = "Nettomuuttoja",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuutot",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain")
# Nettomuutot aluetyypeittäin, viiva
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuutto, color = aluetyyppi)) +
geom_line() +
geom_hline(yintercept = 0, color = "black", size = 1) +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
labs(x = NULL,
y = "Nettomuuttoja",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuutot",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain")
# Nettomuutot aluetyypeittäin, viiva
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuutto, color = aluetyyppi)) +
geom_line() +
geom_hline(yintercept = 0, color = "grey", size = 1) +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
labs(x = NULL,
y = "Nettomuuttoja",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuutot",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain")
# Nettomuutot aluetyypeittäin, viiva
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuutto, color = aluetyyppi)) +
geom_line() +
geom_hline(yintercept = 0, color = "grey", size = 2) +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
labs(x = NULL,
y = "Nettomuuttoja",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuutot",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain")
# Nettomuutot aluetyypeittäin, viiva
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuutto, color = aluetyyppi)) +
geom_line() +
geom_hline(yintercept = 0, color = "grey", size = 1.5) +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
labs(x = NULL,
y = "Nettomuuttoja",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuutot",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain")
# Nettomuutot aluetyypeittäin, viiva
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuutto, color = aluetyyppi)) +
geom_line() +
geom_hline(yintercept = 0, color = "grey", size = 1) +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
labs(x = NULL,
y = "Nettomuuttoja",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuutot",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain")
ggsave("vignettes/nettomuutto_atyyppi_viiva.png")
# Nettomuutot aluetyypeittäin, palkki
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuutto, fill = aluetyyppi)) +
geom_bar(stat = "identity", position = "stack")  +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
labs(x = NULL,
y = "Nettomuuttoja",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuutot",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain")
# Nettomuutot aluetyypeittäin, palkki
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuutto, fill = aluetyyppi)) +
geom_bar(stat = "identity", position = "stack")  +
scale_colour_manual(values = atyyppi_colour) +
geom_hline(yintercept = 0, color = "grey", size = 1) +
theme(legend.title = element_blank()) +
labs(x = NULL,
y = "Nettomuuttoja",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuutot",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain")
ggsave("vignettes/nettomuutto_atyyppi_palkki.png")
# Nettomuuttoasteet aluetyypeittäin, viiva
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values),
vakea = sum(vakiluku)) %>%
mutate(nettomuuttoaste = nettomuutto / vakea) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuuttoaste, color = aluetyyppi)) +
geom_line()  +
scale_colour_manual(values = atyyppi_colour) +
geom_hline(yintercept = 0, color = "grey", size = 1) +
theme(legend.title = element_blank()) +
scale_y_continuous(labels = deci_comma) +
labs(x = NULL,
y = "Nettomuuttoaste",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuuttoasteet",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain suhteessa asukaslukuun")
ggsave("vignettes/nettomuuttoaste_atyyppi_viiva.png")
# Nettomuuttoasteet aluetyypeittäin, palkki
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values),
vakea = sum(vakiluku)) %>%
mutate(nettomuuttoaste = nettomuutto / vakea) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuuttoaste, fill = aluetyyppi)) +
geom_bar(stat = "identity", position = "stack") +
geom_hline(yintercept = 0, color = "grey", size = 1) +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
scale_y_continuous(labels = deci_comma) +
labs(x = NULL,
y = "Nettomuuttoaste",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuuttoasteet",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain suhteessa asukaslukuun")
ggsave("vignettes/nettomuuttoaste_atyyppi_palkki.png")
# Nettomuuttoasteet aluetyypeittäin, palkki
dat_muuttotiedot_kunnittain %>%
filter(Tiedot == "nettomuutto") %>%
group_by(aluetyyppi, Vuosi) %>%
summarize(nettomuutto = sum(values),
vakea = sum(vakiluku)) %>%
mutate(nettomuuttoaste = nettomuutto / vakea) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = nettomuuttoaste, fill = aluetyyppi)) +
geom_bar(stat = "identity", position = "stack") +
# geom_hline(yintercept = 0, color = "grey", size = 1) +
scale_colour_manual(values = atyyppi_colour) +
theme(legend.title = element_blank()) +
scale_y_continuous(labels = deci_comma) +
labs(x = NULL,
y = "Nettomuuttoaste",
caption = "Lähde: PTT, Tilastokeskus",
title = "Nettomuuttoasteet",
subtitle = "Tulo- ja lähtömuuttojen erotus vuosittain suhteessa asukaslukuun")
# Muuta lähtömuuttojen arvot negatiivisiksi
dat_muuttotiedot_kunnittain_mod <- filter(dat_muuttotiedot_kunnittain, Tiedot %in% c("tulomuutto", "lahtomuutto"))
dat_muuttotiedot_kunnittain_mod$values[dat_muuttotiedot_kunnittain_mod$Tiedot == "lahtomuutto"] <-
-dat_muuttotiedot_kunnittain_mod$values[dat_muuttotiedot_kunnittain_mod$Tiedot == "lahtomuutto"]
dat_muuttotiedot_kunnittain_mod %>%
group_by(aluetyyppi, Vuosi, Tiedot) %>%
summarize(muuttoja = sum(values)) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = muuttoja, fill = Tiedot)) +
geom_bar(stat = "identity", position = "stack") +
facet_wrap(~aluetyyppi) +
scale_y_continuous(labels  = deci_comma) +
theme(legend.title = element_blank()) +
scale_fill_manual(labels = c("Lähtömuutto", "Tulomuutto"),
values = c(ggptt_palettes$ptt[3], ggptt_palettes$ptt[1])) +
labs(y = "Muuttoja",
x = NULL,
caption = "Lähde: PTT, Tilastokeskus",
title = "Tulo- ja lähtömuuttoasteet",
subtitle = "Tulo- ja lähtömuutot vuosittain")
dat_muuttotiedot_kunnittain_mod %>%
group_by(aluetyyppi, Vuosi, Tiedot) %>%
summarize(muuttoja = sum(values),
vakea = sum(vakiluku)) %>%
mutate(muuttoaste = muuttoja/vakea) %>%
ungroup() %>%
ggplot(aes(x = Vuosi, y = muuttoaste, fill = Tiedot)) +
geom_bar(stat = "identity", position = "stack") +
facet_wrap(~aluetyyppi) +
scale_y_continuous(labels  = deci_comma) +
theme(legend.title = element_blank()) +
scale_fill_manual(labels = c("Lähtömuutto", "Tulomuutto"),
values = c(ggptt_palettes$ptt[3], ggptt_palettes$ptt[1])) +
labs(y = "Muuttoaste",
x = NULL,
caption = "Lähde: PTT, Tilastokeskus",
title = "Tulo- ja lähtömuuttoasteet",
subtitle = "Tulo- ja lähtömuutot vuosittain suhteessa väkilukuun")
devtools::load_all()
devtools::install_deps()
getOption("repos")
devtools::install_deps(repos = "CRAN")
devtools::load_all()
devtools::install_deps()
install.packages("sampleSelection")
install.packages(c("checkmate", "cluster", "fs", "ggrepel", "lwgeom", "Matching", "officer", "parsedate", "processx", "rcmdcheck", "units", "x13binary"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
devtools::load_all()
load("data/dat_pendelointi.rda")
devtools::load_all(".")
here()
here:here()
install.packages("here")
devtools::load_all()
here()
here:here()
here::here()
kuntakoodit <- readRDS(here::here("data/kuntakoodit2017.rds")) %>%
rename(kunta = Knro, alue = Kunta)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
devtools::load_all()
load("data/dat_pendelointi.rda")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
devtools::load_all()
data("dat_pendelointi")
kuntakoodit <- readRDS(here::here("data/kuntakoodit2017.rds")) %>%
rename(kunta = Knro, alue = Kunta)
kuntakoodit$alue <- as.character(kuntakoodit$alue)
